# 武器槽位

## 单手武器

对于单手武器，一个槽位是没问题的；

![700](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260203070419.png)

## 双手武器

对于双手武器，需要确定一个主槽位（对于右撇子来说一般是右手）和一个副槽位（一般是左手），武器附加在主槽位上，但是由于人物身体的扭转，就会出现副槽位手部穿模的情况，这时候就需要用到手部IK；

![700](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260203070834.png)



![500](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260203070710.png)


# 维持左右手相对距离

[[动画IK#1. Two-Bone IK]]
[[动画IK#5. Hand IK Retargeting]]

![1000](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260203070156.png)

![500](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260203071722.png)

![500](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260203071857.png)

![500](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260203071928.png)


![500](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260203071651.png)


# 同步右手与武器的位置

![400](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260208151753.png)

既然左手已经在维持“相对位置”了，为什么跑步时左手还会插进枪里？

**原因在于：动画中的“相对位置”并不是永恒不变的。**

1.  **蒙皮偏移与肌肉变形：**
    在静止时，右手骨骼和枪的位置关系很稳定。但在剧烈运动（如跑步）时，由于动画压缩、骨骼旋转的累积误差，**右手骨骼（hand_r）相对于枪柄的位置其实是在微小晃动的**。
2.  **节点只管“骨骼”，不管“模型”：**
    `Hand IK Retargeting` 节点只知道：*“我要让左手离右手 30.5 厘米”*。
    它并不知道：*“枪的护木厚度增加了 2 厘米”* 或者 *“枪在这一帧因为动画抖动向左偏了 1 厘米”*。
3.  **滞后效应：**
    如果你的运动动画（奔跑）本身让双手产生了一些非自然的拉伸（Stretch），而 Retargeting 节点试图维持原始动画那个“完美的间距”，这两者之间就会产生冲突。
    *   **结果**：左手虽然努力保持和右手的距离，但枪（挂在右手上）因为动画细节发生了偏移，左手就穿进了枪身。

不要让左手去“死跟”右手。在运动动画中，你应该：

1.  **使用虚拟骨骼**：在右手上加一个虚拟骨骼，精准对齐枪的护木。
2.  **让左手去跟这个虚拟骨骼**，而不是跟右手。
因为虚拟骨骼和枪是同步的，这样无论怎么动，相对位置永远是针对“枪”的，而不是针对“右手关节”的。

## 添加虚拟骨骼

虚拟骨骼不是真正的骨骼（不影响皮肤权重，没有肉体），你可以把它们理解为**在两根现有骨骼之间建立的“实时坐标参考点”**。

在虚幻引擎中使用虚拟骨骼做 IK 优化时，必须遵循这个逻辑：
- 父级（Source）：**必须是主导手（通常是右手，因为枪挂在右手上）。它代表了“参考系”的基准**。
- 目标（Target）：是跟随手（左手）。它代表了动画中那个“理想的握持位置”。
- 结果（Virtual Bone）：产生了一个随枪而动的“虚拟插槽”。

![700](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260203090853.png)

![700](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260203090915.png)

## 复制虚拟骨骼Trans到IK_Hand_L

![600](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260208151537.png)

![400](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260208151655.png)

# 控制左手IK

有时左手不应该IK，比如换弹或者做特殊动作时，需要有方法禁用左手的IK；

![700](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260209022837.png)

![800](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260209023356.png)

![600](https://pic-1315225359.cos.ap-shanghai.myqcloud.com/20260209023517.png)
